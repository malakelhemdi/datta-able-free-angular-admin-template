"use strict";(self.webpackChunkdatta_able_free_angular_admin_template=self.webpackChunkdatta_able_free_angular_admin_template||[]).push([[1456],{8467:(j,g,n)=>{n.r(g),n.d(g,{EmployeeEvaluationRolesManageModule:()=>V});var e=n(177),h=n(9417),S=n(7591),E=n(9947),M=n(4823),D=n(9631),C=n(8834),t=n(3953),b=n(1626),F=n(1441);let p=(()=>{class s{constructor(o,r){this.http=o,this.appConfig=r,this.url=this.appConfig.defaultUrl}UpdateOrganizationalUnit(o){return this.http.put(`${this.url}/api/Position/DefineManagersForTheOrganizationalUnit?culture=ar-LY`,o)}GetManagersForOrganizationalUnit(o){return this.http.get(`${this.url}/api/Position/GetManagersForOrganizationalUnitQuery?culture=ar-LY`,{params:{OrganizationalUnitId:o}})}static#e=this.\u0275fac=function(r){return new(r||s)(t.KVO(b.Qq),t.KVO(F.o))};static#t=this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac})}return s})();var m=n(3471),a=n(1413),d=n(8141),l=n(6496),u=n(3197);let f=(()=>{class s{constructor(o,r){this.employeeEvaluationRolesManageServices=o,this.sharedFacade=r,this.employeeSubject$=new a.B}UpdateOrganizationalUnit(o){const r=this.employeeEvaluationRolesManageServices.UpdateOrganizationalUnit(o).pipe((0,d.M)(i=>{i.type==m.yl.Success?this.sharedFacade.showMessage(m.Go.success,"\u062a\u0645\u062a \u0627\u0644\u062a\u062d\u062f\u064a\u062b \u0628\u0646\u062c\u0627\u062d",i.messages):this.sharedFacade.showMessage(m.Go.error,"\u0644\u0645 \u062a\u062a\u0645 \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u062a\u062d\u062f\u064a\u062b",i.messages)}),(0,l.t)());this.sharedFacade.showLoaderUntilCompleted(r).pipe().subscribe()}GetManagersForOrganizationalUnit(o){const r=this.employeeEvaluationRolesManageServices.GetManagersForOrganizationalUnit(o).pipe((0,d.M)(i=>{i.type==m.yl.Success?this.employeeSubject$.next(i.content[0]):(this.employeeSubject$.next(null),this.sharedFacade.showMessage(m.Go.error,"\u062e\u0637\u0623 \u0641\u064a \u0639\u0645\u0644\u064a\u0629 \u062c\u0644\u0628 \u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646",i.messages))}),(0,l.t)());this.sharedFacade.showLoaderUntilCompleted(r).pipe().subscribe()}static#e=this.\u0275fac=function(r){return new(r||s)(t.KVO(p),t.KVO(u.I))};static#t=this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac})}return s})();var y=n(8498),R=n(2298),w=n(2356),z=n(2016),T=n(2702),I=n(6661);const P=[{path:"",component:(()=>{class s{constructor(o,r,i,v){this.organizationalUnitFacade=o,this.employeeFacade=r,this.employeeEvaluationRolesManageFacade=i,this.fb=v,this.loadEmployees=(c,O,U)=>{this.employeeFacade.GetEmployee(c,O,U)},this.loadOrganizationalUnits=(c,O,U)=>{this.organizationalUnitFacade.GetOrganizationalUnit(c,O,U)},this.employees=this.employeeFacade.employeeSubject$}onDirectManagerSelect(o){this.form.get("directManager").setValue(o)}onHigherLevelManagerSelect(o){this.form.get("higherLevelManager").setValue(o)}onDepartmentManagerSelect(o){this.form.get("departmentManager").setValue(o)}onOrganizationalUnitsSelected(o){this.form.get("organizationalUnit").setValue(o)}ngOnInit(){this.loadOrganizationalUnits(1,10,""),this.loadEmployees(1,10),this.form=this.fb.group({organizationalUnit:[null,h.k0.required],directManager:[""],higherLevelManager:[""],departmentManager:[""]}),this.form.get("organizationalUnit").valueChanges.subscribe(o=>{o&&o.id&&this.employeeEvaluationRolesManageFacade.GetManagersForOrganizationalUnit(o.id)}),this.employeeEvaluationRolesManageFacade.employeeSubject$.subscribe(o=>{this.form.patchValue({directManager:o?.directManagerId,higherLevelManager:o?.higherLevelManagerId,departmentManager:o?.departmentManagerId})})}onSubmit(){this.form.value.organizationalUnit&&this.employeeEvaluationRolesManageFacade.UpdateOrganizationalUnit({id:this.form.value.organizationalUnit.id,departmentManagerId:this.form.value.departmentManager?.id,directManagerId:this.form.value.directManager?.id,higherLevelManagerId:this.form.value.higherLevelManager?.id})}static#e=this.\u0275fac=function(r){return new(r||s)(t.rXU(R.$),t.rXU(w.n),t.rXU(f),t.rXU(h.ok))};static#t=this.\u0275cmp=t.VBU({type:s,selectors:[["employee-evaluation-roles-manage"]],decls:19,vars:21,consts:[[1,"row"],[1,"card"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],[1,"form-group","col-md-6"],[3,"optionSelected","fetchData","data","displayKey","pageSize","placeholder"],[1,"form-group","row"],[1,"form-group","col-md-4"],["type","submit",1,"btn","btn-md","btn-themeAdd","has-ripple"]],template:function(r,i){1&r&&(t.j41(0,"div",0),t.nrm(1,"app-loading")(2,"app-messages"),t.j41(3,"div",1)(4,"div",2)(5,"form",3),t.bIt("ngSubmit",function(){return i.onSubmit()}),t.j41(6,"div",0)(7,"div",4)(8,"div",5)(9,"app-dynamic-dropdown",6),t.bIt("optionSelected",function(c){return i.onOrganizationalUnitsSelected(c)}),t.k0s()()()(),t.j41(10,"div",7)(11,"div",8)(12,"app-dynamic-dropdown",6),t.bIt("optionSelected",function(c){return i.onDirectManagerSelect(c)}),t.k0s()(),t.j41(13,"div",8)(14,"app-dynamic-dropdown",6),t.bIt("optionSelected",function(c){return i.onHigherLevelManagerSelect(c)}),t.k0s()(),t.j41(15,"div",8)(16,"app-dynamic-dropdown",6),t.bIt("optionSelected",function(c){return i.onDepartmentManagerSelect(c)}),t.k0s()()(),t.j41(17,"button",9),t.EFF(18,"\u062d\u0641\u0638"),t.k0s()()()()()),2&r&&(t.R7$(5),t.Y8G("formGroup",i.form),t.R7$(4),t.Y8G("fetchData",i.loadOrganizationalUnits.bind(i))("data",i.organizationalUnitFacade.OrganizationalUnitSubject$)("displayKey","name")("pageSize",10)("placeholder","\u0627\u0644\u0648\u062d\u062f\u0627\u062a \u0627\u0644\u062a\u0646\u0638\u064a\u0645\u064a\u0629"),t.R7$(3),t.Y8G("fetchData",i.loadEmployees.bind(i))("data",i.employees)("displayKey","name")("pageSize",10)("placeholder","\u0627\u0644\u0645\u062f\u064a\u0631 \u0627\u0644\u0645\u0628\u0627\u0634\u0631"),t.R7$(2),t.Y8G("fetchData",i.loadEmployees.bind(i))("data",i.employees)("displayKey","name")("pageSize",10)("placeholder","\u0627\u0644\u0645\u062f\u064a\u0631 \u0627\u0644\u0623\u0639\u0644\u0649"),t.R7$(2),t.Y8G("fetchData",i.loadEmployees.bind(i))("data",i.employees)("displayKey","name")("pageSize",10)("placeholder","\u0645\u062f\u064a\u0631 \u0627\u0644\u0625\u062f\u0627\u0631\u0629"))},dependencies:[h.qT,h.cb,h.j4,z.q,T.y,I.m]})}return s})(),data:{breadcrumb:"\u0625\u062f\u0627\u0631\u0629 \u0645\u0633\u0626\u0648\u0644\u064a\u0646 \u0627\u0644\u062c\u0647\u0627\u062a \u0627\u0644\u062a\u0646\u0638\u064a\u0645\u064a\u0629"}}];let A=(()=>{class s{static#e=this.\u0275fac=function(r){return new(r||s)};static#t=this.\u0275mod=t.$C({type:s});static#a=this.\u0275inj=t.G2t({imports:[y.iI.forChild(P),y.iI]})}return s})();var G=n(3391),$=n(8964),_=n(5842);let V=(()=>{class s{static#e=this.\u0275fac=function(r){return new(r||s)};static#t=this.\u0275mod=t.$C({type:s});static#a=this.\u0275inj=t.G2t({providers:[p,f,R.$,$.p,w.n,_.v],imports:[e.MD,A,h.X1,S.G,E.i,M.uc,D.fS,C.Hl,G.h_]})}return s})()},6661:(j,g,n)=>{n.d(g,{m:()=>F});var e=n(3953),h=n(9417),S=n(1413),E=n(152),M=n(177);const D=["dropdownMenu"];function C(p,m){if(1&p){const a=e.RV6();e.j41(0,"li")(1,"a",8),e.bIt("mousedown",function(){const l=e.eBV(a).$implicit,u=e.XpG();return e.Njj(u.onSelectionChange(l))}),e.EFF(2),e.k0s()()}if(2&p){const a=m.$implicit,d=e.XpG();e.R7$(2),e.SpI(" ",a[d.displayKey]," ")}}function t(p,m){1&p&&(e.j41(0,"li",9)(1,"div",10)(2,"span",11),e.EFF(3,"Loading..."),e.k0s()()())}function b(p,m){1&p&&(e.j41(0,"li",12)(1,"small"),e.EFF(2,"\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a"),e.k0s()())}let F=(()=>{class p{constructor(){this.pageSize=10,this.placeholder="\u0627\u062e\u062a\u0631 \u062e\u064a\u0627\u0631\u0627\u064b",this.optionSelected=new e.bkB,this.items=[],this.currentPage=1,this.totalCount=0,this.loading=!1,this.isDisabled=!1,this.searchQuery="",this.selectedOption=null,this.searchSubject=new S.B,this.onChange=()=>{},this.onTouched=()=>{},this.searchSubject.pipe((0,E.B)(500)).subscribe(a=>{this.searchQuery=a,this.currentPage=1,this.fetchData(this.currentPage,this.pageSize,a)})}ngOnChanges(a){a.data&&this.data&&this.handleData()}handleData(){this.data.subscribe(a=>{this.items=1===this.currentPage?a.items:[...this.items,...a.items],this.totalCount=a.totalCount,this.loading=!1})}onScroll(a){const d=a.target;d.scrollTop+d.clientHeight+5>=d.scrollHeight&&!this.loading&&this.items.length<this.totalCount&&(this.loading=!0,this.currentPage++,this.fetchData(this.currentPage,this.pageSize,this.searchQuery))}onSelectionChange(a){this.onChange(this.formControlNameSpecificAccessAttribute?a[this.formControlNameSpecificAccessAttribute]:a),this.selectedOption=a,this.optionSelected.emit(a),this.onTouched(),this.closeDropdown()}toggleDropdown(){if(this.isDisabled)return;const a=this.dropdownMenu.nativeElement;a.style.display="block"===a.style.display?"none":"block"}closeDropdown(){setTimeout(()=>{this.dropdownMenu.nativeElement.style.display="none"},150)}onSearch(a){this.searchSubject.next(a)}writeValue(a){this.selectedOption=a}registerOnChange(a){this.onChange=a}registerOnTouched(a){this.onTouched=a}setDisabledState(a){this.isDisabled=a}static#e=this.\u0275fac=function(d){return new(d||p)};static#t=this.\u0275cmp=e.VBU({type:p,selectors:[["app-dynamic-dropdown"]],viewQuery:function(d,l){if(1&d&&e.GBs(D,5),2&d){let u;e.mGM(u=e.lsd())&&(l.dropdownMenu=u.first)}},inputs:{fetchData:"fetchData",data:"data",displayKey:"displayKey",pageSize:"pageSize",placeholder:"placeholder",ngClass:"ngClass",formControlNameSpecificAccessAttribute:"formControlNameSpecificAccessAttribute"},outputs:{optionSelected:"optionSelected"},features:[e.Jv_([{provide:h.kq,useExisting:(0,e.Rfq)(()=>p),multi:!0}]),e.OA$],decls:10,vars:8,consts:[["dropdownContainer",""],["dropdownMenu",""],[1,"dropdown","w-100"],["type","text","readonly","","required","",1,"form-control",3,"blur","click","input","value","disabled","placeholder","ngClass"],[1,"dropdown-menu","w-100","overflow-auto",2,"max-height","250px","min-width","100%","display","none",3,"scroll"],[4,"ngFor","ngForOf"],["class","text-center py-2",4,"ngIf"],["class","text-center py-2 text-muted",4,"ngIf"],["href","javascript:void(0)",1,"dropdown-item",3,"mousedown"],[1,"text-center","py-2"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-center","py-2","text-muted"]],template:function(d,l){if(1&d){const u=e.RV6();e.j41(0,"div",2,0)(2,"label"),e.EFF(3),e.k0s(),e.j41(4,"input",3),e.bIt("blur",function(){return e.eBV(u),e.Njj(l.closeDropdown())})("click",function(){return e.eBV(u),e.Njj(l.toggleDropdown())})("input",function(y){return e.eBV(u),e.Njj(l.onSearch(y.target.value))}),e.k0s(),e.j41(5,"ul",4,1),e.bIt("scroll",function(y){return e.eBV(u),e.Njj(l.onScroll(y))}),e.DNE(7,C,3,1,"li",5)(8,t,4,0,"li",6)(9,b,3,0,"li",7),e.k0s()()}2&d&&(e.R7$(3),e.JRh(l.placeholder),e.R7$(),e.FS9("placeholder",l.placeholder),e.Y8G("value",l.selectedOption?l.selectedOption[l.displayKey]:"")("disabled",l.isDisabled)("ngClass",l.ngClass),e.R7$(3),e.Y8G("ngForOf",l.items),e.R7$(),e.Y8G("ngIf",l.loading),e.R7$(),e.Y8G("ngIf",0===l.items.length&&!l.loading))},dependencies:[M.YU,M.Sq,M.bT],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.loading-option[_ngcontent-%COMP%]{font-style:italic;text-align:center;color:gray}.custom-panel[_ngcontent-%COMP%]{max-height:200px!important;overflow:hidden!important}.cdk-virtual-scroll-container[_ngcontent-%COMP%]{height:200px;overflow-y:auto}"]})}return p})()},2802:(j,g,n)=>{n.d(g,{A:()=>h});const h={currentPage:0,items:[],pageSize:0,totalCount:0,totalPages:0}}}]);