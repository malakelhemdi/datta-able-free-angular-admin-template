"use strict";(self.webpackChunkdatta_able_free_angular_admin_template=self.webpackChunkdatta_able_free_angular_admin_template||[]).push([[985],{985:(q,g,s)=>{s.r(g),s.d(g,{ConnectedServiceModule:()=>w});var v=s(177),i=s(9417),x=s(7591),F=s(9947),G=s(4823),j=s(9631),Y=s(8834),b=s(8498),f=s(7530),m=s(1490);function p(u,r){const t=+(0,m.a)(u)-+(0,m.a)(r);return t<0?-1:t>0?1:t}function V(u,r,t){const[n,o,a]=(0,f.x)(t?.in,u,u,r),c=p(o,a),l=Math.abs(function I(u,r,t){const[n,o]=(0,f.x)(t?.in,u,r);return 12*(n.getFullYear()-o.getFullYear())+(n.getMonth()-o.getMonth())}(o,a));if(l<1)return 0;1===o.getMonth()&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-c*l);let d=p(o,a)===-c;(function N(u,r){const t=(0,m.a)(u,r?.in);return+function $(u,r){const t=(0,m.a)(u,r?.in);return t.setHours(23,59,59,999),t}(t,r)==+function S(u,r){const t=(0,m.a)(u,r?.in),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}(t,r)})(n)&&1===l&&1===p(n,a)&&(d=!1);const h=c*(l-+d);return 0===h?0:h}var O=s(4053);function E(u,r,t){const[n,o]=(0,f.x)(t?.in,u,r),a=C(n,o),c=Math.abs((0,O.m)(n,o));n.setDate(n.getDate()-a*c);const d=a*(c-+(C(n,o)===-a));return 0===d?0:d}function C(u,r){const t=u.getFullYear()-r.getFullYear()||u.getMonth()-r.getMonth()||u.getDate()-r.getDate()||u.getHours()-r.getHours()||u.getMinutes()-r.getMinutes()||u.getSeconds()-r.getSeconds()||u.getMilliseconds()-r.getMilliseconds();return t<0?-1:t>0?1:t}var B=s(7862),e=s(3953),z=s(4412),L=s(8141),X=s(6496),D=s(2802),A=s(3471),P=s(8655),_=s(3197);let M=(()=>{class u{constructor(t,n){this.employeeGlobalServices=t,this.sharedFacade=n,this.employeeSubject$=new z.t(D.A)}GetEmployee(t,n,o,a){const c=this.employeeGlobalServices.GetEmployee(t,n,o,a).pipe((0,L.M)(l=>{l.type==A.yl.Success?this.employeeSubject$.next(l.content):(this.employeeSubject$.next(D.A),this.sharedFacade.showMessage(A.Go.error,"\u062e\u0637\u0623 \u0641\u064a \u0639\u0645\u0644\u064a\u0629 \u062c\u0644\u0628 \u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646",l.messages))}),(0,X.t)());this.sharedFacade.showLoaderUntilCompleted(c).pipe().subscribe()}static#e=this.\u0275fac=function(n){return new(n||u)(e.KVO(P.U),e.KVO(_.I))};static#t=this.\u0275prov=e.jDH({token:u,factory:u.\u0275fac})}return u})();var H=s(2016),U=s(2702);const y=u=>({"is-invalid":u});function K(u,r){if(1&u&&(e.j41(0,"app-card",9)(1,"div",10)(2,"div",11)(3,"label",12),e.EFF(4,"\u0623\u0633\u0645 \u0627\u0644\u0645\u0648\u0638\u0641"),e.k0s(),e.nrm(5,"input",13),e.k0s(),e.j41(6,"div",11)(7,"label",12),e.EFF(8,"\u0627\u0644\u0623\u062f\u0627\u0631\u0629"),e.k0s(),e.nrm(9,"input",13),e.k0s(),e.j41(10,"div",14)(11,"label",15),e.EFF(12,"\u0623\u062e\u0631 \u0645\u0643\u0627\u0641\u0623\u0629"),e.k0s(),e.nrm(13,"input",16),e.k0s(),e.j41(14,"div",11)(15,"label",15),e.EFF(16,"\u062a\u0627\u0631\u064a\u062e \u0623\u062e\u0631 \u0645\u0643\u0627\u0641\u0623\u0629"),e.k0s(),e.j41(17,"div",17),e.nrm(18,"input",16)(19,"input",16),e.k0s()()()()),2&u){const t=e.XpG();e.Y8G("options",!1),e.R7$(5),e.Y8G("value",t.form.get("employee").value.name),e.R7$(4),e.Y8G("value",t.form.get("employee").value.managementName)}}function J(u,r){if(1&u){const t=e.RV6();e.j41(0,"div",29)(1,"div",30)(2,"label",31),e.EFF(3,"\u0623\u0633\u0645 \u0627\u0644\u0634\u0631\u0643\u0629"),e.k0s(),e.nrm(4,"input",32),e.j41(5,"div",33),e.EFF(6,"\u0623\u0633\u0645 \u0627\u0644\u0634\u0631\u0643\u0629 \u0645\u0637\u0644\u0648\u0628."),e.k0s()(),e.j41(7,"div",30)(8,"label",31),e.EFF(9,"\u0645\u0646"),e.k0s(),e.nrm(10,"input",34),e.j41(11,"div",33),e.EFF(12,"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0628\u062f\u0627\u064a\u0629 \u0645\u0637\u0644\u0648\u0628."),e.k0s()(),e.j41(13,"div",30)(14,"label",31),e.EFF(15,"\u0625\u0644\u0649"),e.k0s(),e.nrm(16,"input",35),e.j41(17,"div",33),e.EFF(18),e.k0s()(),e.j41(19,"div",36)(20,"label",31),e.EFF(21,"\u0641\u062a\u0631\u0629 \u0627\u0644\u0639\u0645\u0644 \u0641\u064a \u0627\u0644\u0635\u062d\u0631\u0627\u0621"),e.k0s(),e.nrm(22,"input",37),e.j41(23,"div",33),e.EFF(24,"\u0641\u062a\u0631\u0629 \u0627\u0644\u0639\u0645\u0644 \u0641\u064a \u0627\u0644\u0635\u062d\u0631\u0627\u0621 \u0645\u0637\u0644\u0648\u0628\u0629 \u0648\u064a\u062c\u0628 \u0623\u0646 \u062a\u0643\u0648\u0646 0 \u0623\u0648 \u0623\u0643\u0628\u0631."),e.k0s()(),e.j41(25,"div",38)(26,"button",39),e.bIt("click",function(){const o=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.removePreviousExperience(o))}),e.EFF(27," \u062d\u0630\u0641 "),e.k0s()()()}if(2&u){let t;const n=r.$implicit,o=r.index,a=e.XpG(2);e.Y8G("formGroupName",o),e.R7$(2),e.Mz_("for","companyName-",o,""),e.R7$(2),e.Mz_("id","companyName-",o,""),e.Y8G("ngClass",e.eq3(23,y,n.get("companyName").invalid&&n.get("companyName").touched)),e.R7$(4),e.Mz_("for","from-",o,""),e.R7$(2),e.Mz_("id","from-",o,""),e.Y8G("ngClass",e.eq3(25,y,n.get("from").invalid&&n.get("from").touched)),e.R7$(4),e.Mz_("for","to-",o,""),e.R7$(2),e.Mz_("id","to-",o,""),e.Y8G("ngClass",e.eq3(27,y,(null==n.errors?null:n.errors.dateRangeInvalid)&&n.get("to").touched)),e.R7$(2),e.SpI(" ",null!=n.errors&&n.errors.dateRangeInvalid?"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0646\u0647\u0627\u064a\u0629 \u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0628\u0639\u062f \u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0628\u062f\u0627\u064a\u0629.":"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0646\u0647\u0627\u064a\u0629 \u0645\u0637\u0644\u0648\u0628."," "),e.R7$(2),e.Mz_("for","fieldDays-",o,""),e.R7$(2),e.Mz_("id","fieldDays-",o,""),e.Y8G("ngClass",e.eq3(29,y,(null==(t=n.get("fieldDays"))?null:t.invalid)&&(null==(t=n.get("fieldDays"))?null:t.touched))),e.R7$(4),e.Y8G("disabled",a.getAsFormArray(a.form.get("previousExperience")).length<=1)}}function Q(u,r){if(1&u){const t=e.RV6();e.j41(0,"app-card",18)(1,"div",19),e.DNE(2,J,28,31,"div",20),e.j41(3,"div",10)(4,"div",21)(5,"div",22),e.EFF(6,"\u0635\u0627\u0641\u064a \u0633\u0646\u0648\u0627\u062a \u0627\u0644\u062e\u0628\u0631\u0629"),e.k0s()(),e.j41(7,"div",23)(8,"label",24),e.EFF(9,"\u0623\u064a\u0627\u0645"),e.k0s(),e.nrm(10,"input",25),e.k0s(),e.j41(11,"div",23)(12,"label",24),e.EFF(13,"\u0634\u0647\u0648\u0631"),e.k0s(),e.nrm(14,"input",25),e.k0s(),e.j41(15,"div",23)(16,"label",24),e.EFF(17,"\u0633\u0646\u0648\u0627\u062a"),e.k0s(),e.nrm(18,"input",25),e.k0s()(),e.j41(19,"div",10)(20,"div",21)(21,"div",22),e.EFF(22,"\u0639\u062f\u062f \u0623\u064a\u0627\u0645 \u0627\u0644\u0639\u0637\u0644"),e.k0s()(),e.j41(23,"div",26)(24,"label",24),e.EFF(25,"\u0623\u064a\u0627\u0645"),e.k0s(),e.nrm(26,"input",25),e.k0s()(),e.j41(27,"div",27)(28,"button",28),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.addPreviousExperience())}),e.EFF(29,"\u0623\u0636\u0641 \u062e\u0628\u0631\u0629 \u062c\u062f\u064a\u062f\u0629"),e.k0s()()()()}if(2&u){const t=e.XpG();e.Y8G("options",!1),e.R7$(2),e.Y8G("ngForOf",t.getAsFormArray(t.form.get("previousExperience")).controls),e.R7$(8),e.Y8G("value",t.totalExperience.days),e.R7$(4),e.Y8G("value",t.totalExperience.months),e.R7$(4),e.Y8G("value",t.totalExperience.years),e.R7$(8),e.Y8G("value",t.totalVacationDays)}}const W=[{path:"",component:(()=>{class u{constructor(t,n){this.connectedServiceFacade=t,this.fb=n,this.totalExperience={days:0,months:0,years:0},this.totalVacationDays=0,this.currentDate=(0,B.GP)(new Date,"yyyy-MM-dd")}ngOnInit(){this.form=this.fb.group({employee:[null,i.k0.required],previousExperience:this.fb.array([this.createExperienceGroup()])}),this.form.get("previousExperience").valueChanges.subscribe(t=>{this.totalExperience={days:0,months:0,years:0},t.forEach(n=>{if(n?.from&&n.to){if(this.dateRangeValueValidator(n?.from,n?.to))return void alert("\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0646\u0647\u0627\u064a\u0629 \u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0628\u0639\u062f \u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0628\u062f\u0627\u064a\u0629");const o=function T(u,r){const t=new Date(u),n=new Date(r),l=function R(u,r,t){const[n,o]=(0,f.x)(t?.in,u,r),a=p(n,o),c=Math.abs(function k(u,r,t){const[n,o]=(0,f.x)(t?.in,u,r);return n.getFullYear()-o.getFullYear()}(n,o));n.setFullYear(1584),o.setFullYear(1584);const d=a*(c-+(p(n,o)===-a));return 0===d?0:d}(n,t),d=V(n,t)-12*l;return{years:l,months:d,days:E(n,t)-E(new Date(t.getFullYear()+l,t.getMonth()+d,t.getDate()),t)}}(n.from,n.to);this.totalExperience={days:this.totalExperience.days+o.days,months:this.totalExperience.months+o.months,years:this.totalExperience.years+o.years}}}),this.totalVacationDays=30*this.totalExperience.years}),this.connectedServiceFacade.employeeSubject$.subscribe(t=>{this.form.get("employee").setValue(t.items[0])})}dateRangeValidator(t){const n=t.get("from")?.value,o=t.get("to")?.value;return n&&o?new Date(n)<=new Date(o)?null:{dateRangeInvalid:!0}:null}dateRangeValueValidator(t,n){return t&&n?new Date(t)>=new Date(n):null}createExperienceGroup(){return this.fb.group({companyName:[null,i.k0.required],from:[null,i.k0.required],to:[null,i.k0.required],fieldDays:[null,[i.k0.required,i.k0.min(0)]],totalVacation:[null,[i.k0.required,i.k0.min(0)]]},{validators:this.dateRangeValidator})}addPreviousExperience(){this.form.get("previousExperience").push(this.createExperienceGroup())}removePreviousExperience(t){const n=this.form.get("previousExperience");n.length>1&&n.removeAt(t)}getAsFormArray(t){return t}setEmployeeByCode(t){t&&this.connectedServiceFacade.GetEmployee(1,1,"1",t)}static#e=this.\u0275fac=function(n){return new(n||u)(e.rXU(M),e.rXU(i.ok))};static#t=this.\u0275cmp=e.VBU({type:u,selectors:[["connected-service"]],decls:14,vars:4,consts:[["employee_code",""],["cardTitle","\u0628\u062d\u062b \u0639\u0646 \u0627\u0644\u0645\u0648\u0638\u0641","blockClass","table-border-style",3,"options"],["for","employee_code",1,"form-label"],["id","employee_code","aria-describedby","employee_code",1,"form-control"],["type","button",1,"btn","btn-outline-info","mt-3",3,"click"],[1,"feather","icon-info"],[3,"formGroup"],["cardTitle","\u0645\u0639\u0644\u0648\u0645\u0627\u062a \u0627\u0644\u0645\u0648\u0638\u0641","blockClass","table-border-style",3,"options",4,"ngIf"],["cardTitle","\u0645\u062f\u0629 \u0627\u0644\u0639\u0645\u0644 \u0645\u0639 \u0634\u0631\u0643\u0627\u062a \u0623\u062e\u0631\u0649","blockClass","table-border-style",3,"options",4,"ngIf"],["cardTitle","\u0645\u0639\u0644\u0648\u0645\u0627\u062a \u0627\u0644\u0645\u0648\u0638\u0641","blockClass","table-border-style",3,"options"],[1,"row"],[1,"col-sm-6","mb-3"],["for","employee_name",1,"form-label"],["disabled","","id","employee_name",1,"form-control",3,"value"],[1,"col-sm-3","mb-3"],["for","",1,"form-label"],["disabled","","id","",1,"form-control"],[1,"d-flex","gap-3"],["cardTitle","\u0645\u062f\u0629 \u0627\u0644\u0639\u0645\u0644 \u0645\u0639 \u0634\u0631\u0643\u0627\u062a \u0623\u062e\u0631\u0649","blockClass","table-border-style",3,"options"],["formArrayName","previousExperience"],["class","row mb-3 border-bottom pb-3",3,"formGroupName",4,"ngFor","ngForOf"],[1,"col-3","d-flex"],[1,"m-auto"],[1,"col-3"],[1,"form-label"],["disabled","","type","number",1,"form-control",3,"value"],[1,"col-9"],[1,"text-end","mt-3"],["type","button",1,"btn","btn-success",3,"click"],[1,"row","mb-3","border-bottom","pb-3",3,"formGroupName"],[1,"col-md-3"],[1,"form-label",3,"for"],["formControlName","companyName",1,"form-control",3,"id","ngClass"],[1,"invalid-feedback"],["type","date","formControlName","from",1,"form-control",3,"id","ngClass"],["type","date","formControlName","to",1,"form-control",3,"id","ngClass"],[1,"col-md-2"],["type","number","formControlName","fieldDays",1,"form-control",3,"id","ngClass"],[1,"col-md-1","d-flex","align-items-end"],["type","button",1,"btn","btn-danger","mt-2",3,"click","disabled"]],template:function(n,o){if(1&n){const a=e.RV6();e.nrm(0,"app-loading")(1,"app-messages"),e.j41(2,"app-card",1)(3,"div")(4,"label",2),e.EFF(5,"\u0631\u0642\u0645 \u0627\u0644\u0645\u0648\u0638\u0641"),e.k0s(),e.nrm(6,"input",3,0),e.j41(8,"button",4),e.bIt("click",function(){e.eBV(a);const l=e.sdS(7);return e.Njj(o.setEmployeeByCode(l.value))}),e.EFF(9," \u0628\u062d\u062b "),e.nrm(10,"i",5),e.k0s()()(),e.j41(11,"form",6),e.DNE(12,K,20,3,"app-card",7)(13,Q,30,6,"app-card",8),e.k0s()}2&n&&(e.R7$(2),e.Y8G("options",!1),e.R7$(9),e.Y8G("formGroup",o.form),e.R7$(),e.Y8G("ngIf",o.form.get("employee").value),e.R7$(),e.Y8G("ngIf",o.form.get("employee").value))},dependencies:[v.YU,v.Sq,v.bT,i.qT,i.me,i.Q0,i.BC,i.cb,i.j4,i.JD,i.$R,i.v8,H.q,U.y,F.i]})}return u})(),data:{breadcrumb:"\u0627\u0644\u0633\u062c\u0644 \u0627\u0644\u0635\u062d\u064a"}}];let Z=(()=>{class u{static#e=this.\u0275fac=function(n){return new(n||u)};static#t=this.\u0275mod=e.$C({type:u});static#n=this.\u0275inj=e.G2t({imports:[b.iI.forChild(W),b.iI]})}return u})(),w=(()=>{class u{static#e=this.\u0275fac=function(n){return new(n||u)};static#t=this.\u0275mod=e.$C({type:u});static#n=this.\u0275inj=e.G2t({providers:[M],imports:[v.MD,i.YN,Z,i.X1,x.G,F.i,G.uc,j.fS,Y.Hl]})}return u})()}}]);