"use strict";(self.webpackChunkdatta_able_free_angular_admin_template=self.webpackChunkdatta_able_free_angular_admin_template||[]).push([[7245],{2880:(G,y,s)=>{s.r(y),s.d(y,{EmployeeEvaluationManagementModule:()=>ne});var i=s(177),f=s(8498),r=s(9417),S=s(4572),e=s(3953),C=s(9783),M=s(3507),D=s(2016),b=s(2702),T=s(6661),v=s(9947),_=s(4249),l=s(3805);let d=(()=>{class a{transform(t,o){return t&&o?t.value.reduce((p,c)=>Number(p)+(Number(c[o])?Number(c[o]):0),0):0}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275pipe=e.EJ8({name:"totalScore",type:a,pure:!1})}return a})();const m=a=>({"is-invalid":a}),h=()=>[2021,2022,2023,2024],E=a=>({active:a});function F(a,u){if(1&a&&(e.j41(0,"option",17),e.EFF(1),e.k0s()),2&a){const t=u.$implicit;e.Y8G("ngValue",t),e.R7$(),e.SpI(" ",null==t?null:t.name," ")}}function I(a,u){if(1&a){const t=e.RV6();e.j41(0,"select",15),e.bIt("change",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onEmployeeTypeSelect())}),e.DNE(1,F,2,2,"option",16),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("ngClass",e.eq3(2,m,t.evaluationForm.get("employee").invalid&&t.evaluationForm.get("employee").touched)),e.R7$(),e.Y8G("ngForOf",t.allEmployees)}}function N(a,u){1&a&&(e.j41(0,"div",18),e.EFF(1," \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062e\u062a\u064a\u0627\u0631 \u0645\u0648\u0638\u0641. "),e.k0s())}function k(a,u){if(1&a&&(e.j41(0,"option",19),e.EFF(1),e.k0s()),2&a){const t=u.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function x(a,u){1&a&&(e.j41(0,"div",18),e.EFF(1," \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062e\u062a\u064a\u0627\u0631 \u0627\u0644\u0633\u0646\u0629. "),e.k0s())}function A(a,u){if(1&a&&(e.j41(0,"h5",23),e.EFF(1),e.k0s()),2&a){const t=e.XpG(2);e.R7$(),e.JRh(t.evaluationForm.get("evaluationType").value.name)}}function R(a,u){1&a&&(e.j41(0,"div",18),e.EFF(1," \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062e\u062a\u064a\u0627\u0631 \u0646\u0648\u0639 \u0627\u0644\u062a\u0642\u064a\u064a\u0645. "),e.k0s())}function j(a,u){if(1&a){const t=e.RV6();e.j41(0,"div",20)(1,"app-dynamic-dropdown",21),e.bIt("optionSelected",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onEvaluationTypeSelect())}),e.k0s(),e.DNE(2,A,2,1,"h5",22)(3,R,2,0,"div",9),e.k0s()}if(2&a){const t=e.XpG();e.R7$(),e.Y8G("ngClass",e.eq3(8,m,t.evaluationForm.get("evaluationType").invalid&&t.evaluationForm.get("evaluationType").touched))("fetchData",t.loadEmployeeEvaluationTypes.bind(t))("data",t.employeeEvaluationTypes)("displayKey","name")("pageSize",10)("placeholder","\u0627\u0644\u0631\u062c\u0627\u0621 \u0625\u062e\u062a\u064a\u0627\u0631 \u062a\u0642\u064a\u064a\u0645"),e.R7$(),e.Y8G("ngIf",t.evaluationId),e.R7$(),e.Y8G("ngIf",t.evaluationForm.get("evaluationType").invalid&&t.evaluationForm.get("evaluationType").touched)}}function $(a,u){if(1&a){const t=e.RV6();e.j41(0,"li",28),e.bIt("click",function(){const n=e.eBV(t).$implicit,p=e.XpG(2);return e.Njj(p.onSelectedEvalutionItemChange(n))}),e.j41(1,"button",29),e.EFF(2),e.k0s()()}if(2&a){const t=u.$implicit,o=u.index,n=e.XpG(2);e.Y8G("formGroupName",o),e.R7$(),e.Y8G("ngClass",e.eq3(3,E,(null==n.selectedEvaluationFormGroup?null:n.selectedEvaluationFormGroup.get("evaluationItemName").value)===t.get("evaluationItemName").value)),e.R7$(),e.SpI(" ",t.get("evaluationItemName").value," ")}}function w(a,u){1&a&&(e.j41(0,"div",6),e.EFF(1," \u0627\u0644\u062d\u062f \u0627\u0644\u0623\u0639\u0644\u0649 "),e.k0s())}function Y(a,u){1&a&&e.nrm(0,"input",41),2&a&&e.Y8G("readOnly",!0)}function O(a,u){if(1&a&&(e.j41(0,"div",0),e.nrm(1,"input",38)(2,"input",39),e.DNE(3,Y,1,1,"input",40),e.k0s()),2&a){const t=e.XpG().$implicit,o=e.XpG(3);e.R7$(),e.Y8G("readOnly",!o.isFieldAvailable("DirectManager")||o.isDisabledField)("ngClass",e.eq3(9,m,t.get("DirectManagerScore").invalid&&t.get("DirectManagerScore").touched))("type","Text"===o.selectedEvaluationFormGroup.get("evaluationItemType").value?"text":"number")("max",t.get("maxScore").value),e.R7$(),e.Y8G("readOnly",!o.isFieldAvailable("HigherLevelManager")||o.isDisabledField)("type","Text"===o.selectedEvaluationFormGroup.get("evaluationItemType").value?"text":"number")("ngClass",e.eq3(11,m,t.get("HigherLevelManagerScore").invalid&&t.get("HigherLevelManagerScore").touched))("max",t.get("maxScore").value),e.R7$(),e.Y8G("ngIf","Number"===o.selectedEvaluationFormGroup.get("evaluationItemType").value)}}function B(a,u){if(1&a&&e.EFF(0),2&a){const t=e.XpG().$implicit;e.SpI(" ",t.get("elementName").value," ")}}function L(a,u){if(1&a&&e.EFF(0),2&a){const t=e.XpG().$implicit;e.SpI(" ",t.get("maxScore").value," ")}}function P(a,u){if(1&a&&e.EFF(0),2&a){const t=e.XpG().$implicit;e.SpI(" ",t.get("elementName").value," ")}}function H(a,u){if(1&a&&e.EFF(0),2&a){const t=e.XpG().$implicit;e.SpI(" ",t.get("maxScore").value," ")}}function V(a,u){if(1&a&&(e.j41(0,"div",0)(1,"div",42),e.nrm(2,"input",43),e.j41(3,"label",44),e.DNE(4,B,1,1)(5,L,1,1),e.k0s()(),e.j41(6,"div",42),e.nrm(7,"input",45),e.j41(8,"label",44),e.DNE(9,P,1,1)(10,H,1,1),e.k0s()()()),2&a){const t=u.$implicit,o=u.$index,n=e.XpG(2).index,p=e.XpG(3);e.R7$(2),e.Y8G("id",o+""+n+"DirectManagerScore")("value","Boolean"===p.selectedEvaluationFormGroup.get("evaluationItemType").value?t.get("elementName").value:t.get("maxScore").value),e.R7$(),e.Y8G("for",o+""+n+"DirectManagerScore"),e.R7$(),e.vxM("Boolean"===p.selectedEvaluationFormGroup.get("evaluationItemType").value?4:5),e.R7$(3),e.Y8G("id",o+""+n+"HigherLevelManagerScore")("value","Boolean"===p.selectedEvaluationFormGroup.get("evaluationItemType").value?t.get("elementName").value:t.get("maxScore").value),e.R7$(),e.Y8G("for",o+""+n+"HigherLevelManagerScore"),e.R7$(),e.vxM("Boolean"===p.selectedEvaluationFormGroup.get("evaluationItemType").value?9:10)}}function U(a,u){if(1&a&&e.Z7z(0,V,11,8,"div",0,e.Vm6),2&a){const t=e.XpG(4);e.Dyx(t.getFormArray(t.selectedEvaluationFormGroup.get("scores")).controls)}}function X(a,u){if(1&a&&(e.j41(0,"div",37)(1,"div",32),e.EFF(2),e.k0s(),e.j41(3,"div",6),e.DNE(4,O,4,13,"div",0)(5,U,2,0),e.k0s()()),2&a){const t=u.$implicit,o=u.index,n=e.XpG(3);e.Y8G("formGroupName",o),e.R7$(2),e.JRh(t.get("elementName").value),e.R7$(2),e.vxM("Number"===n.selectedEvaluationFormGroup.get("evaluationItemType").value||"Text"===n.selectedEvaluationFormGroup.get("evaluationItemType").value?4:5)}}function K(a,u){if(1&a&&(e.j41(0,"div",0)(1,"h3",32)(2,"strong"),e.EFF(3,"\u0627\u0644\u0645\u062c\u0645\u0648\u0639"),e.k0s()(),e.j41(4,"div",6)(5,"div",0),e.nrm(6,"input",46),e.nI1(7,"totalScore"),e.nrm(8,"input",47),e.nI1(9,"totalScore"),e.nrm(10,"input",48),e.nI1(11,"totalScore"),e.k0s()()()),2&a){const t=e.XpG(3);e.R7$(6),e.Y8G("value",e.i5U(7,3,t.getFormArray(t.selectedEvaluationFormGroup.get("scores")),"DirectManagerScore")),e.R7$(2),e.Y8G("value",e.i5U(9,6,t.getFormArray(t.selectedEvaluationFormGroup.get("scores")),"HigherLevelManagerScore")),e.R7$(2),e.Y8G("value",e.i5U(11,9,t.getFormArray(t.selectedEvaluationFormGroup.get("scores")),"maxScore"))}}function z(a,u){if(1&a&&(e.j41(0,"div",30)(1,"app-card",31)(2,"div",0),e.nrm(3,"div",32),e.j41(4,"div",6)(5,"div",0)(6,"div",6),e.EFF(7,"\u0627\u0644\u0631\u0626\u064a\u0633 \u0627\u0644\u0645\u0628\u0627\u0634\u0631"),e.k0s(),e.j41(8,"div",6),e.EFF(9,"\u0627\u0644\u0631\u0626\u064a\u0633 \u0627\u0644\u0623\u0639\u0644\u0649"),e.k0s(),e.DNE(10,w,2,0,"div",33),e.k0s()()(),e.j41(11,"div",34),e.DNE(12,X,6,3,"div",35)(13,K,12,12,"div",36),e.k0s()()()),2&a){const t=e.XpG(2);e.Y8G("formGroup",t.selectedEvaluationFormGroup),e.R7$(),e.Y8G("cardTitle",t.selectedEvaluationFormGroup.get("evaluationItemName").value)("options",!1),e.R7$(9),e.Y8G("ngIf","Number"===t.selectedEvaluationFormGroup.get("evaluationItemType").value),e.R7$(2),e.Y8G("ngForOf",t.getFormArray(t.selectedEvaluationFormGroup.get("scores")).controls),e.R7$(),e.Y8G("ngIf","Number"===t.selectedEvaluationFormGroup.get("evaluationItemType").value)}}function J(a,u){if(1&a&&(e.j41(0,"div",49)(1,"app-card",50)(2,"div",51),e.nrm(3,"input",52),e.j41(4,"label",53),e.EFF(5,"\u0627\u0644\u0631\u0626\u064a\u0633 \u0627\u0644\u0645\u0628\u0627\u0634\u0631"),e.k0s()(),e.j41(6,"div",54),e.nrm(7,"input",55),e.j41(8,"label",56),e.EFF(9,"\u0627\u0644\u0631\u0626\u064a\u0633 \u0627\u0644\u0623\u0639\u0644\u0649"),e.k0s()(),e.j41(10,"div",57),e.nrm(11,"input",58),e.j41(12,"label",59),e.EFF(13,"\u0645\u062f\u064a\u0631 \u0627\u0644\u0625\u062f\u0627\u0631\u0629"),e.k0s()(),e.j41(14,"div",60),e.nrm(15,"input",61),e.j41(16,"label",62),e.EFF(17,"\u0634\u0624\u0648\u0646 \u0627\u0644\u0639\u0627\u0645\u0644\u064a\u0646"),e.k0s()(),e.j41(18,"div",63)(19,"h5"),e.EFF(20,"\u0627\u0644\u0645\u062c\u0645\u0648\u0639 \u0627\u0644\u0643\u0644\u064a"),e.k0s(),e.j41(21,"div",64),e.nrm(22,"input",65),e.nI1(23,"sumAllScores"),e.nrm(24,"input",65),e.nI1(25,"sumLargestScores"),e.k0s()()()()),2&a){const t=e.XpG(2);e.R7$(),e.Y8G("options",!1),e.R7$(21),e.Y8G("value",e.i5U(23,3,t.getFormArray(t.evaluationForm.get("evaluationScores")),"maxScore")),e.R7$(2),e.Y8G("value",e.bMT(25,6,t.getFormArray(t.evaluationForm.get("evaluationScores"))))}}function Q(a,u){if(1&a&&(e.j41(0,"div",20)(1,"ul",24),e.DNE(2,$,3,5,"li",25),e.k0s(),e.DNE(3,z,14,6,"div",26)(4,J,26,8,"div",27),e.k0s()),2&a){const t=e.XpG();e.R7$(2),e.Y8G("ngForOf",t.getFormArray(t.evaluationForm.get("evaluationScores")).controls),e.R7$(),e.Y8G("ngIf",t.selectedEvaluationFormGroup),e.R7$(),e.Y8G("ngIf",t.getFormArray(t.evaluationForm.get("evaluationScores")).length)}}const W=[{path:"",component:(()=>{class a{constructor(t,o,n){this.showEmployeeEvaluationTypeFacade=t,this.employeeEvaluationManagementFacade=o,this.fb=n,this.subscriptions=[],this.isDisabledField=!0}onSelectedEvalutionItemChange(t){this.selectedEvaluationFormGroup=t,this.setActiveFields()}loadEmployeeEvaluationTypes(t,o,n){this.showEmployeeEvaluationTypeFacade.fetchEmployeeEvaluationTypes(t,o)}ngOnInit(){this.loadEmployeeEvaluationTypes(1,10),this.employeeEvaluationManagementFacade.GetEmployeesGroupedByManagerType(),this.evaluationForm=this.fb.group({employee:["",r.k0.required],evaluationType:["",r.k0.required],year:[null,r.k0.required],evaluationScores:this.fb.array([]),approvals:this.fb.group({DirectManager:this.fb.group({status:[{value:!1,disabled:!0},r.k0.required],approvedDate:[null]}),HigherLevelManager:this.fb.group({status:[{value:!1,disabled:!0},r.k0.required],approvedDate:[null]}),DepartmentManager:this.fb.group({status:[{value:!1,disabled:!0},r.k0.required],approvedDate:[null]}),PersonnelAffairs:this.fb.group({status:[{value:!1,disabled:!0},r.k0.required],approvedDate:[null]})})}),this.employeeEvaluationManagementFacade.groupedEmployeesByManager$.subscribe(t=>{this.groupedEmployeesByManager=t,this.allEmployees=[...t?.employees?.DepartmentManager?t?.employees?.DepartmentManager:[],...t?.employees?.HigherLevelManager?t?.employees?.HigherLevelManager:[],...t?.employees?.DirectManager?t?.employees?.DirectManager:[]]}),(0,S.z)([this.employeeEvaluationManagementFacade.selectedEmployeeEvaluation$,this.employeeEvaluationTypes]).subscribe(([t,o])=>{let n=[];if(t&&o){const p=o.items.find(c=>c.id===t.evaluationScores.evaluationType.id);this.evaluationForm.get("evaluationType").setValue(p),n=t.evaluationScores.evaluationScores.map(c=>this.fb.group({evaluationItemName:[c.evaluationItemName,r.k0.required],evaluationItemType:[c.evaluationItemType,r.k0.required],scores:this.fb.array(c.scores.map(g=>this.fb.group({elementName:[g.elementName,r.k0.required],DirectManagerScore:[g.DirectManagerScore,this.getValidation(c.evaluationItemType,g.maxScore)],HigherLevelManagerScore:[g.HigherLevelManagerScore,this.getValidation(c.evaluationItemType,g.maxScore)],maxScore:[g.maxScore]})))})),this.evaluationForm.get("approvals").patchValue(t.evaluationScores.approvals),this.evaluationId=t.id}else this.evaluationId=void 0,this.evaluationForm.get("evaluationType").setValue(void 0),this.evaluationForm.get("approvals").patchValue({DirectManager:{status:!1,approvedDate:null},HigherLevelManager:{status:!1,approvedDate:null},DepartmentManager:{status:!1,approvedDate:null},PersonnelAffairs:{status:!1,approvedDate:null}});this.selectedEvaluationFormGroup=void 0,this.evaluationForm.setControl("evaluationScores",this.fb.array(n)),this.setActiveFields()})}get employeeEvaluationTypes(){return this.showEmployeeEvaluationTypeFacade.employeeEvaluationTypes$}get selectedEvalutionType(){return this.evaluationForm.get("evaluationType")?.value}onEmployeeTypeSelect(){const t=this.evaluationForm.get("employee")?.value,o=this.evaluationForm.get("year")?.value;this.groupedEmployeesByManager&&(this.groupedEmployeesByManager?.employees?.DirectManager&&this.groupedEmployeesByManager.employees.DirectManager.find(n=>n.id===t.id)?this.currentEmployeeRelationshipToSignInUserType="DirectManager":this.groupedEmployeesByManager?.employees?.DepartmentManager&&this.groupedEmployeesByManager.employees.DepartmentManager.find(n=>n.id===t.id)?this.currentEmployeeRelationshipToSignInUserType="DepartmentManager":this.groupedEmployeesByManager?.employees?.HigherLevelManager&&this.groupedEmployeesByManager.employees.HigherLevelManager.find(n=>n.id===t.id)&&(this.currentEmployeeRelationshipToSignInUserType="HigherLevelManager"),this.setActiveFields()),o&&t&&this.employeeEvaluationManagementFacade.GetEmployeeEvaluation(t.id,o)}onYearSelect(){const t=this.evaluationForm.get("year")?.value,o=this.evaluationForm.get("employee")?.value;t&&o&&this.employeeEvaluationManagementFacade.GetEmployeeEvaluation(o.id,t)}onEvaluationTypeSelect(){const t=this.evaluationForm.get("evaluationType")?.value;if(!t)return;this.selectedEvaluationFormGroup=null;const o=t.evaluationData.EvaluationItems.map(n=>this.fb.group({evaluationItemName:[n.ItemName,r.k0.required],evaluationItemType:[n.type,r.k0.required],scores:this.fb.array(n.Elements.map(p=>this.fb.group({elementName:[p.ElementName,r.k0.required],DirectManagerScore:[0,this.getValidation(n.type,p.Value)],HigherLevelManagerScore:[0,this.getValidation(n.type,p.Value)],maxScore:[p.Value]})))}));this.evaluationForm.setControl("evaluationScores",this.fb.array(o||[]))}getValidation(t,o=1/0){return"Number"===t?[r.k0.required,r.k0.max(o),r.k0.min(0)]:"Text"===t?[r.k0.required]:"Range"===t?[r.k0.required,r.k0.pattern(/^\d+\s*-\s*\d+$/)]:[]}onSubmit(){if(this.evaluationForm.valid){this.evaluationForm.get("approvals").get(this.currentEmployeeRelationshipToSignInUserType).get("approvedDate").setValue(new Date);const t=this.evaluationForm.getRawValue();if(this.evaluationForm.get("evaluationScores").untouched){if(!confirm("\u0644\u0645 \u062a\u0642\u0645 \u0628\u062a\u063a\u064a\u0631 \u0627\u064a \u0642\u064a\u0645\u0629 \u0641\u064a \u0627\u064a \u062d\u0642\u0644, \u0645\u062a\u0627\u0628\u0639\u0629\u061f"))return;this.addUpdateNewEvaluation(t)}else this.addUpdateNewEvaluation(t)}else alert("\u062a\u0623\u0643\u062f \u0645\u0646 \u0627\u0644\u0642\u064a\u0645 \u0627\u0644\u0645\u0637\u0644\u0648\u0628\u0629")}addUpdateNewEvaluation(t){const o=this.calculateTotalLargerScore(t)/this.sumEvaluationScores(t,"maxScore")*100,n={employeeId:t.employee.id,year:t.year,isApproved:this.getIsApprovedValue(t),totalScore:this.calculateTotalLargerScore(t),percentage:+o.toFixed(3),evaluationId:this.calculateEvaluationId(o),evaluationTypeId:t.evaluationType.id,evaluationDate:(new Date).toISOString(),evaluationScores:t};this.evaluationId?this.employeeEvaluationManagementFacade.updateEmployeeEvaluation({...n,id:this.evaluationId}):this.employeeEvaluationManagementFacade.AddEmployeeEvaluation(n)}getFormArray(t){return t}setActiveFields(){const t=this.evaluationForm.get("approvals").getRawValue(),o=()=>t.HigherLevelManager.status||t.DepartmentManager.status||t.PersonnelAffairs.status,n=(p,c)=>{const g=this.evaluationForm.get("approvals").get(p);c?g.disable({onlySelf:!0,emitEvent:!1}):g.enable({onlySelf:!0,emitEvent:!1}),this.isDisabledField=c};switch(this.currentEmployeeRelationshipToSignInUserType){case"DirectManager":n("DirectManager",o());break;case"HigherLevelManager":n("HigherLevelManager",o());break;case"DepartmentManager":n("DepartmentManager",o());break;default:console.warn("Unknown manager type:",this.currentEmployeeRelationshipToSignInUserType)}}calculateTotalLargerScore(t){return t.evaluationScores.filter(o=>"Number"===o.evaluationItemType).reduce((o,n)=>o+n.scores.reduce((c,g)=>c+Math.max(g.DirectManagerScore,g.HigherLevelManagerScore),0),0)}getIsApprovedValue(t){return t.approvals.PersonnelAffairs.status?4:t.approvals.DepartmentManager.status?3:t.approvals.HigherLevelManager.status?2:t.approvals.DirectManager.status?1:0}sumEvaluationScores(t,o){return t&&t.evaluationScores?t.evaluationScores.filter(n=>"Number"===n.evaluationItemType).reduce((n,p)=>n+p.scores.reduce((c,g)=>c+(g[o]||0),0),0):0}calculateEvaluationId(t){return t>90?1:t>75?2:t>60?3:t>45?4:5}isFieldAvailable(t){return{DirectManager:["DirectManager","DepartmentManager"],HigherLevelManager:["HigherLevelManager","DepartmentManager"],DepartmentManager:["DirectManager","HigherLevelManager","DepartmentManager"]}[t]?.includes(this.currentEmployeeRelationshipToSignInUserType)||!1}ngOnDestroy(){}static#e=this.\u0275fac=function(o){return new(o||a)(e.rXU(C.M),e.rXU(M.o),e.rXU(r.ok))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-employee-evaluation-management"]],decls:24,vars:12,consts:[[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group","row"],[1,"col-sm-4"],["for","employee"],["formControlName","employee","class","form-select",3,"ngClass","change",4,"ngIf"],["class","invalid-feedback",4,"ngIf"],["for","year"],["formControlName","year",1,"form-select",3,"change","ngClass"],[3,"value",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],["type","submit",1,"btn","btn-md","btn-themeAdd","has-ripple",3,"disabled"],["formControlName","employee",1,"form-select",3,"change","ngClass"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"invalid-feedback"],[3,"value"],[1,"form-group"],["formControlName","evaluationType",3,"optionSelected","ngClass","fetchData","data","displayKey","pageSize","placeholder"],["style","font-weight: bold",4,"ngIf"],[2,"font-weight","bold"],["formArrayName","evaluationScores","id","myTab","role","tablist",1,"nav","nav-tabs"],["class","nav-item","role","presentation",3,"formGroupName","click",4,"ngFor","ngForOf"],[3,"formGroup",4,"ngIf"],["formGroupName","approvals",4,"ngIf"],["role","presentation",1,"nav-item",3,"click","formGroupName"],["type","button","role","tab",1,"nav-link",3,"ngClass"],[3,"formGroup"],["blockClass","table-border-style",3,"cardTitle","options"],[1,"col-sm-8"],["class","col-sm-4",4,"ngIf"],["formArrayName","scores",1,"row","gap-2"],["class","row",3,"formGroupName",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[1,"row",3,"formGroupName"],["formControlName","DirectManagerScore","name","DirectManagerScore","min","0",1,"col-sm-4","scoreBox",3,"readOnly","ngClass","type","max"],["formControlName","HigherLevelManagerScore","name","HigherLevelManagerScore","min","0",1,"col-sm-4","scoreBox",3,"readOnly","type","ngClass","max"],["formControlName","maxScore","type","number","name","maxScore","class","col-sm-4 scoreBox",3,"readOnly",4,"ngIf"],["formControlName","maxScore","type","number","name","maxScore",1,"col-sm-4","scoreBox",3,"readOnly"],[1,"d-flex","gap-1","col-sm-4"],["type","radio","formControlName","DirectManagerScore",1,"form-check-input",3,"id","value"],[1,"form-check-label",3,"for"],["type","radio","formControlName","HigherLevelManagerScore",1,"form-check-input",3,"id","value"],["disabled","","name","DirectManagerScore",1,"col-sm-4","scoreBox",3,"value"],["disabled","","name","HigherLevelManagerScore",1,"col-sm-4","scoreBox",3,"value"],["disabled","","name","maxScore",1,"col-sm-4","scoreBox",3,"value"],["formGroupName","approvals"],["form","","cardTitle","\u0627\u0644\u062a\u0642\u064a\u064a\u0645\u0627\u062a","blockClass","table-border-style",3,"options"],["formGroupName","DirectManager",1,"form-check"],["formControlName","status","type","checkbox","id","directManagerStatus",1,"form-check-input"],["for","directManagerStatus",1,"form-check-label"],["formGroupName","HigherLevelManager",1,"form-check"],["formControlName","status","type","checkbox","id","HigherLevelManagerStatus",1,"form-check-input"],["for","HigherLevelManagerStatus",1,"form-check-label"],["formGroupName","DepartmentManager",1,"form-check"],["formControlName","status","type","checkbox","id","DepartmentManagerStatus",1,"form-check-input"],["for","DepartmentManagerStatus",1,"form-check-label"],["formGroupName","PersonnelAffairs",1,"form-check"],["formControlName","status","type","checkbox","id","personnelAffairsStatus",1,"form-check-input"],["for","personnelAffairsStatus",1,"form-check-label"],[1,"d-flex","gap-2","mt-4"],[1,"d-flex","gap-1"],["disabled","","type","number",3,"value"]],template:function(o,n){1&o&&(e.j41(0,"div",0),e.nrm(1,"app-loading")(2,"app-messages"),e.j41(3,"div",1)(4,"div",2)(5,"div",3)(6,"form",4),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(7,"div",5)(8,"div",6)(9,"label",7),e.EFF(10,"\u0627\u0644\u0645\u0648\u0638\u0641"),e.k0s(),e.DNE(11,I,2,4,"select",8)(12,N,2,0,"div",9),e.k0s(),e.j41(13,"div",6)(14,"label",10),e.EFF(15,"\u0627\u0644\u0633\u0646\u0629"),e.k0s(),e.j41(16,"select",11),e.bIt("change",function(){return n.onYearSelect()}),e.DNE(17,k,2,2,"option",12),e.k0s(),e.DNE(18,x,2,0,"div",9),e.k0s()(),e.DNE(19,j,4,10,"div",13)(20,Q,5,3,"div",13),e.j41(21,"button",14),e.EFF(22," \u062d\u0641\u0638 "),e.k0s()()()()(),e.nrm(23,"div",1),e.k0s()),2&o&&(e.R7$(6),e.Y8G("formGroup",n.evaluationForm),e.R7$(5),e.Y8G("ngIf",!!n.groupedEmployeesByManager),e.R7$(),e.Y8G("ngIf",n.evaluationForm.get("employee").invalid&&n.evaluationForm.get("employee").touched),e.R7$(4),e.Y8G("ngClass",e.eq3(9,m,n.evaluationForm.get("year").invalid&&n.evaluationForm.get("year").touched)),e.R7$(),e.Y8G("ngForOf",e.lJ4(11,h)),e.R7$(),e.Y8G("ngIf",n.evaluationForm.get("year").invalid&&n.evaluationForm.get("year").touched),e.R7$(),e.Y8G("ngIf",n.evaluationForm.get("employee").value),e.R7$(),e.Y8G("ngIf",n.selectedEvalutionType&&n.evaluationForm.get("employee").value),e.R7$(),e.Y8G("disabled",!n.evaluationForm.valid||n.evaluationForm.untouched))},dependencies:[i.YU,i.Sq,i.bT,r.qT,r.xH,r.y7,r.me,r.Q0,r.Zm,r.wz,r.Fm,r.BC,r.cb,r.j4,r.JD,r.$R,r.v8,D.q,b.y,T.m,v.i,_.m,l.V,d],styles:[".is-invalid[_ngcontent-%COMP%]{border-color:red;border-width:3px}input[disabled][_ngcontent-%COMP%]{pointer-events:none!important;opacity:.6!important}"]})}return a})(),data:{breadcrumb:"\u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u062a\u0642\u064a\u064a\u0645\u0627\u062a"}}];let q=(()=>{class a{static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275mod=e.$C({type:a});static#a=this.\u0275inj=e.G2t({imports:[f.iI.forChild(W),f.iI]})}return a})();var Z=s(6881),ee=s(7591),te=s(4823),ae=s(9631),oe=s(8834);let ne=(()=>{class a{static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275mod=e.$C({type:a});static#a=this.\u0275inj=e.G2t({providers:[Z.E,M.o],imports:[i.MD,q,r.X1,ee.G,r.YN,v.i,te.uc,ae.fS,oe.Hl]})}return a})()},6661:(G,y,s)=>{s.d(y,{m:()=>T});var i=s(3953),f=s(9417),r=s(1413),S=s(152),e=s(177);const C=["dropdownMenu"];function M(v,_){if(1&v){const l=i.RV6();i.j41(0,"li")(1,"a",8),i.bIt("mousedown",function(){const m=i.eBV(l).$implicit,h=i.XpG();return i.Njj(h.onSelectionChange(m))}),i.EFF(2),i.k0s()()}if(2&v){const l=_.$implicit,d=i.XpG();i.R7$(2),i.SpI(" ",l[d.displayKey]," ")}}function D(v,_){1&v&&(i.j41(0,"li",9)(1,"div",10)(2,"span",11),i.EFF(3,"Loading..."),i.k0s()()())}function b(v,_){1&v&&(i.j41(0,"li",12)(1,"small"),i.EFF(2,"\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a"),i.k0s()())}let T=(()=>{class v{constructor(){this.pageSize=10,this.placeholder="\u0627\u062e\u062a\u0631 \u062e\u064a\u0627\u0631\u0627\u064b",this.optionSelected=new i.bkB,this.items=[],this.currentPage=1,this.totalCount=0,this.loading=!1,this.isDisabled=!1,this.searchQuery="",this.selectedOption=null,this.searchSubject=new r.B,this.onChange=()=>{},this.onTouched=()=>{},this.searchSubject.pipe((0,S.B)(500)).subscribe(l=>{this.searchQuery=l,this.currentPage=1,this.fetchData(this.currentPage,this.pageSize,l)})}ngOnChanges(l){l.data&&this.data&&this.handleData()}handleData(){this.data.subscribe(l=>{this.items=1===this.currentPage?l.items:[...this.items,...l.items],this.totalCount=l.totalCount,this.loading=!1})}onScroll(l){const d=l.target;d.scrollTop+d.clientHeight+5>=d.scrollHeight&&!this.loading&&this.items.length<this.totalCount&&(this.loading=!0,this.currentPage++,this.fetchData(this.currentPage,this.pageSize,this.searchQuery))}onSelectionChange(l){this.onChange(this.formControlNameSpecificAccessAttribute?l[this.formControlNameSpecificAccessAttribute]:l),this.selectedOption=l,this.optionSelected.emit(l),this.onTouched(),this.closeDropdown()}toggleDropdown(){if(this.isDisabled)return;const l=this.dropdownMenu.nativeElement;l.style.display="block"===l.style.display?"none":"block"}closeDropdown(){setTimeout(()=>{this.dropdownMenu.nativeElement.style.display="none"},150)}onSearch(l){this.searchSubject.next(l)}writeValue(l){this.selectedOption=l}registerOnChange(l){this.onChange=l}registerOnTouched(l){this.onTouched=l}setDisabledState(l){this.isDisabled=l}static#e=this.\u0275fac=function(d){return new(d||v)};static#t=this.\u0275cmp=i.VBU({type:v,selectors:[["app-dynamic-dropdown"]],viewQuery:function(d,m){if(1&d&&i.GBs(C,5),2&d){let h;i.mGM(h=i.lsd())&&(m.dropdownMenu=h.first)}},inputs:{fetchData:"fetchData",data:"data",displayKey:"displayKey",pageSize:"pageSize",placeholder:"placeholder",ngClass:"ngClass",formControlNameSpecificAccessAttribute:"formControlNameSpecificAccessAttribute"},outputs:{optionSelected:"optionSelected"},features:[i.Jv_([{provide:f.kq,useExisting:(0,i.Rfq)(()=>v),multi:!0}]),i.OA$],decls:10,vars:8,consts:[["dropdownContainer",""],["dropdownMenu",""],[1,"dropdown","w-100"],["type","text","readonly","","required","",1,"form-control",3,"blur","click","input","value","disabled","placeholder","ngClass"],[1,"dropdown-menu","w-100","overflow-auto",2,"max-height","250px","min-width","100%","display","none",3,"scroll"],[4,"ngFor","ngForOf"],["class","text-center py-2",4,"ngIf"],["class","text-center py-2 text-muted",4,"ngIf"],["href","javascript:void(0)",1,"dropdown-item",3,"mousedown"],[1,"text-center","py-2"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-center","py-2","text-muted"]],template:function(d,m){if(1&d){const h=i.RV6();i.j41(0,"div",2,0)(2,"label"),i.EFF(3),i.k0s(),i.j41(4,"input",3),i.bIt("blur",function(){return i.eBV(h),i.Njj(m.closeDropdown())})("click",function(){return i.eBV(h),i.Njj(m.toggleDropdown())})("input",function(F){return i.eBV(h),i.Njj(m.onSearch(F.target.value))}),i.k0s(),i.j41(5,"ul",4,1),i.bIt("scroll",function(F){return i.eBV(h),i.Njj(m.onScroll(F))}),i.DNE(7,M,3,1,"li",5)(8,D,4,0,"li",6)(9,b,3,0,"li",7),i.k0s()()}2&d&&(i.R7$(3),i.JRh(m.placeholder),i.R7$(),i.FS9("placeholder",m.placeholder),i.Y8G("value",m.selectedOption?m.selectedOption[m.displayKey]:"")("disabled",m.isDisabled)("ngClass",m.ngClass),i.R7$(3),i.Y8G("ngForOf",m.items),i.R7$(),i.Y8G("ngIf",m.loading),i.R7$(),i.Y8G("ngIf",0===m.items.length&&!m.loading))},dependencies:[e.YU,e.Sq,e.bT],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.loading-option[_ngcontent-%COMP%]{font-style:italic;text-align:center;color:gray}.custom-panel[_ngcontent-%COMP%]{max-height:200px!important;overflow:hidden!important}.cdk-virtual-scroll-container[_ngcontent-%COMP%]{height:200px;overflow-y:auto}"]})}return v})()},2802:(G,y,s)=>{s.d(y,{A:()=>f});const f={currentPage:0,items:[],pageSize:0,totalCount:0,totalPages:0}}}]);