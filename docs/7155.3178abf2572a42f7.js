"use strict";(self.webpackChunkdatta_able_free_angular_admin_template=self.webpackChunkdatta_able_free_angular_admin_template||[]).push([[7155],{7155:(g,v,i)=>{i.r(v),i.d(v,{AddEmployeeEvaluationTypeModule:()=>H});var p=i(177),c=i(8498),n=i(9417),r=i(5336),e=i(3953),d=i(3471),_=i(1413),F=i(4412),E=i(8141),y=i(6496),h=i(2802),T=i(3197),A=i(1626),C=i(1441);let f=(()=>{class u{constructor(t,o){this.http=t,this.appConfig=o,this.url=this.appConfig.defaultUrl}AddEmployeeEvaluationType(t){return this.http.post(`${this.url}/api/EvaluationsTypes/AddEvaluationType?culture=ar-LY`,t)}updateEmployeeEvaluationType(t){return this.http.put(`${this.url}/api/EvaluationsTypes/UpdateEvaluationType?culture=ar-LY`,t)}getEmployeeEvaluationType(t,o,a){return this.http.get(`${this.url}/api/EvaluationsTypes/GetEvaluationsTypes?culture=ar-LY&Id=${a}&Page=${t}&PageSize=${o}`)}static#e=this.\u0275fac=function(o){return new(o||u)(e.KVO(A.Qq),e.KVO(C.o))};static#t=this.\u0275prov=e.jDH({token:u,factory:u.\u0275fac})}return u})(),b=(()=>{class u{constructor(t,o){this.sharedFacade=t,this.addEmployeeEvaluationTypeServices=o,this.AddEmployeeEvaluationSubject$=new _.B,this.AddEmployeeEvaluation$=this.AddEmployeeEvaluationSubject$.asObservable(),this.employeeEvaluationTypesSubject$=new F.t(h.A)}AddEmployeeEvaluationType(t){const o=this.addEmployeeEvaluationTypeServices.AddEmployeeEvaluationType(t).pipe((0,E.M)(a=>{a.type==d.yl.Success?(this.sharedFacade.showMessage(d.Go.success,"\u062a\u0645\u062a \u0627\u0644\u0625\u0636\u0627\u0641\u0629 \u0628\u0646\u062c\u0627\u062d",a.messages),this.AddEmployeeEvaluationSubject$.next(a)):(this.sharedFacade.showMessage(d.Go.error,"\u0644\u0645 \u062a\u062a\u0645 \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u0625\u0636\u0627\u0641\u0629",a.messages),this.AddEmployeeEvaluationSubject$.next(a))}),(0,y.t)());this.sharedFacade.showLoaderUntilCompleted(o).pipe().subscribe()}fetchEmployeeEvaluationType(t,o,a){const l=this.addEmployeeEvaluationTypeServices.getEmployeeEvaluationType(t,o,a).pipe((0,E.M)(m=>{m.type==d.yl.Success?this.employeeEvaluationTypesSubject$.next(m.content):(this.employeeEvaluationTypesSubject$.next(h.A),this.sharedFacade.showMessage(d.Go.error,"\u062e\u0637\u0623 \u0641\u064a \u0639\u0645\u0644\u064a\u0629 \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u062a\u0642\u064a\u064a\u0645",m.messages))}),(0,y.t)());this.sharedFacade.showLoaderUntilCompleted(l).pipe().subscribe()}UpdateEmployeeEvaluationType(t){const o=this.addEmployeeEvaluationTypeServices.updateEmployeeEvaluationType(t).pipe((0,E.M)(a=>{a.type==d.yl.Success?(this.sharedFacade.showMessage(d.Go.success,"\u062a\u0645\u062a \u0627\u0644\u062a\u0639\u062f\u064a\u0644 \u0628\u0646\u062c\u0627\u062d",a.messages),this.AddEmployeeEvaluationSubject$.next(a)):(this.sharedFacade.showMessage(d.Go.error,"\u0644\u0645 \u062a\u062a\u0645 \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u062a\u0639\u062f\u064a\u0644",a.messages),this.AddEmployeeEvaluationSubject$.next(a))}),(0,y.t)());this.sharedFacade.showLoaderUntilCompleted(o).pipe().subscribe()}static#e=this.\u0275fac=function(o){return new(o||u)(e.KVO(T.I),e.KVO(f))};static#t=this.\u0275prov=e.jDH({token:u,factory:u.\u0275fac})}return u})();var k=i(2016),j=i(2702);function $(u,s){1&u&&(e.j41(0,"small"),e.EFF(1,"\u0627\u0644\u0627\u0633\u0645 \u0645\u0637\u0644\u0648\u0628."),e.k0s())}function I(u,s){1&u&&(e.j41(0,"small"),e.EFF(1,"\u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0627\u0644\u0627\u0633\u0645 4 \u0623\u062d\u0631\u0641 \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644."),e.k0s())}function N(u,s){if(1&u&&(e.j41(0,"div",16),e.DNE(1,$,2,0,"small",17)(2,I,2,0,"small",17),e.k0s()),2&u){let t,o;const a=e.XpG();e.R7$(),e.Y8G("ngIf",null==(t=a.evaluationForm.get("name"))||null==t.errors?null:t.errors.required),e.R7$(),e.Y8G("ngIf",null==(o=a.evaluationForm.get("name"))||null==o.errors?null:o.errors.minlength)}}function G(u,s){1&u&&(e.j41(0,"div",18)(1,"small"),e.EFF(2,"\u064a\u062c\u0628 \u0625\u0636\u0627\u0641\u0629 \u0639\u0646\u0635\u0631 \u062a\u0642\u064a\u064a\u0645 \u0648\u0627\u062d\u062f \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644."),e.k0s()())}function R(u,s){1&u&&(e.j41(0,"div",16)(1,"small"),e.EFF(2,"\u0627\u0633\u0645 \u0627\u0644\u0639\u0646\u0635\u0631 \u0645\u0637\u0644\u0648\u0628."),e.k0s()())}function S(u,s){if(1&u&&(e.j41(0,"option",33),e.EFF(1),e.k0s()),2&u){const t=s.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function x(u,s){1&u&&(e.j41(0,"div",18)(1,"small"),e.EFF(2,"\u064a\u062c\u0628 \u0625\u0636\u0627\u0641\u0629 \u0639\u0646\u0635\u0631 \u0648\u0627\u062d\u062f \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644."),e.k0s()())}function V(u,s){1&u&&(e.j41(0,"div",16)(1,"small"),e.EFF(2,"\u0627\u0633\u0645 \u0627\u0644\u0639\u0646\u0635\u0631 \u0645\u0637\u0644\u0648\u0628."),e.k0s()())}function Y(u,s){1&u&&e.nrm(0,"input",44)}function D(u,s){1&u&&e.nrm(0,"input",45)}function O(u,s){1&u&&e.nrm(0,"input",46)}function M(u,s){1&u&&e.nrm(0,"input",47)}function X(u,s){1&u&&(e.j41(0,"small"),e.EFF(1,"\u0627\u0644\u0642\u064a\u0645\u0629 \u0645\u0637\u0644\u0648\u0628\u0629."),e.k0s())}function U(u,s){1&u&&(e.j41(0,"small"),e.EFF(1,"\u064a\u062c\u0628 \u0623\u0646 \u062a\u0643\u0648\u0646 \u0627\u0644\u0642\u064a\u0645\u0629 \u0631\u0642\u0645\u064b\u0627."),e.k0s())}function w(u,s){if(1&u&&(e.j41(0,"div",16),e.DNE(1,X,2,0,"small",17)(2,U,2,0,"small",17),e.k0s()),2&u){let t,o;const a=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",null==(t=a.get("Value"))||null==t.errors?null:t.errors.required),e.R7$(),e.Y8G("ngIf",null==(o=a.get("Value"))||null==o.errors?null:o.errors.pattern)}}function B(u,s){if(1&u){const t=e.RV6();e.j41(0,"div",34)(1,"h5"),e.EFF(2),e.k0s(),e.j41(3,"div",3)(4,"label",35),e.EFF(5,"\u0627\u0633\u0645 \u0627\u0644\u0639\u0646\u0635\u0631"),e.k0s(),e.nrm(6,"input",36),e.DNE(7,V,3,0,"div",6),e.k0s(),e.j41(8,"div",3)(9,"label",37),e.EFF(10,"\u0627\u0644\u0642\u064a\u0645\u0629"),e.k0s(),e.qex(11,38),e.DNE(12,Y,1,0,"input",39)(13,D,1,0,"input",40)(14,O,1,0,"input",41)(15,M,1,0,"input",42),e.bVm(),e.DNE(16,w,3,2,"div",6),e.k0s(),e.j41(17,"button",43),e.bIt("click",function(){const a=e.eBV(t).index,l=e.XpG().index,m=e.XpG();return e.Njj(m.removeElement(l,a))}),e.EFF(18,"\u062d\u0630\u0641 \u0627\u0644\u0639\u0646\u0635\u0631"),e.k0s()()}if(2&u){let t,o;const a=s.$implicit,l=s.index,m=e.XpG().$implicit;e.Y8G("formGroupName",l),e.R7$(2),e.SpI("\u0639\u0646\u0635\u0631 ",l+1,""),e.R7$(5),e.Y8G("ngIf",(null==(t=a.get("ElementName"))?null:t.invalid)&&(null==(t=a.get("ElementName"))?null:t.touched)),e.R7$(4),e.Y8G("ngSwitch",m.get("type").value),e.R7$(),e.Y8G("ngSwitchCase","Number"),e.R7$(),e.Y8G("ngSwitchCase","Text"),e.R7$(),e.Y8G("ngSwitchCase","Range"),e.R7$(),e.Y8G("ngSwitchCase","Boolean"),e.R7$(),e.Y8G("ngIf",(null==(o=a.get("Value"))?null:o.invalid)&&(null==(o=a.get("Value"))?null:o.touched))}}function P(u,s){if(1&u){const t=e.RV6();e.j41(0,"div",19)(1,"div",1)(2,"h4",20),e.EFF(3),e.k0s(),e.j41(4,"div",3)(5,"label",21),e.EFF(6,"\u0627\u0633\u0645 \u0627\u0644\u0639\u0646\u0635\u0631"),e.k0s(),e.nrm(7,"input",22),e.DNE(8,R,3,0,"div",6),e.k0s(),e.j41(9,"div",23),e.nrm(10,"input",24),e.j41(11,"label",25),e.EFF(12,"\u063a\u064a\u0631 \u0646\u0634\u0637"),e.k0s()(),e.j41(13,"div",3)(14,"label",26),e.EFF(15,"\u0646\u0648\u0639 \u0627\u0644\u0639\u0646\u0635\u0631"),e.k0s(),e.j41(16,"select",27),e.DNE(17,S,2,2,"option",28),e.k0s()(),e.j41(18,"div",29),e.DNE(19,x,3,0,"div",11)(20,B,19,9,"div",30),e.j41(21,"button",31),e.bIt("click",function(){const a=e.eBV(t),l=a.$implicit,m=a.index,J=e.XpG();return e.Njj(J.addElementToItem(m,l.get("type").value))}),e.EFF(22," \u0625\u0636\u0627\u0641\u0629 \u0639\u0646\u0635\u0631 "),e.k0s()(),e.j41(23,"button",32),e.bIt("click",function(){const a=e.eBV(t).index,l=e.XpG();return e.Njj(l.removeEvaluationItem(a))}),e.EFF(24,"\u062d\u0630\u0641 \u0639\u0646\u0635\u0631 \u0627\u0644\u062a\u0642\u064a\u064a\u0645"),e.k0s()()()}if(2&u){let t;const o=s.$implicit,a=s.index,l=e.XpG();e.Y8G("formGroupName",a),e.R7$(3),e.SpI("\u0639\u0646\u0635\u0631 \u0627\u0644\u062a\u0642\u064a\u064a\u0645 ",a+1,""),e.R7$(5),e.Y8G("ngIf",(null==(t=o.get("ItemName"))?null:t.invalid)&&(null==(t=o.get("ItemName"))?null:t.touched)),e.R7$(2),e.Mz_("id","disabled",a,""),e.R7$(),e.Mz_("for","disabled",a,""),e.R7$(3),e.Mz_("for","type",a,""),e.R7$(2),e.Mz_("id","type",a,""),e.R7$(),e.Y8G("ngForOf",l.elementTypes),e.R7$(2),e.Y8G("ngIf",l.getElements(a).invalid&&l.getElements(a).touched),e.R7$(),e.Y8G("ngForOf",l.getElements(a).controls)}}const z=[{path:"",component:(()=>{class u{constructor(t,o,a,l){this.fb=t,this.addEmployeeEvaluationTypeFacade=o,this.ActivatedRoute=a,this.router=l,this.elementTypes=Object.values(r.R)}ngOnInit(){this.ActivatedRoute.queryParams.subscribe(t=>{t.id?(this.addEmployeeEvaluationTypeFacade.fetchEmployeeEvaluationType(1,1,t.id),this.id=t.id):this.id=void 0}),this.employeeEvaluationTypesSubjectSub=this.addEmployeeEvaluationTypeFacade.employeeEvaluationTypesSubject$.subscribe(t=>{this.evaluationForm=t&&t.items.length>0?this.createEvaluationForm(t.items[0]):this.createEvaluationForm()})}ngOnDestroy(){this.employeeEvaluationTypesSubjectSub&&this.employeeEvaluationTypesSubjectSub.unsubscribe()}createEvaluationForm(t){return this.fb.group({name:[t?.name||"",[n.k0.required,n.k0.minLength(4)]],isForCitizens:[t?.isForCitizens||!1],evaluationData:this.fb.group({EvaluationItems:this.fb.array(t?.evaluationData?.EvaluationItems?.map(o=>this.createEvaluationItemGroup(o))||[],n.k0.required)},{validators:this.atLeastOneItemValidator("EvaluationItems")})})}createEvaluationItemGroup(t){return this.fb.group({ItemName:[t.ItemName||"",n.k0.required],disabled:[t.disabled||!1],type:[t.type||r.R.Number,n.k0.required],Elements:this.fb.array(t.Elements.map(o=>this.createElementGroup(o,t.type)),n.k0.required)})}createElementGroup(t,o){let a=[n.k0.required];switch(o){case r.R.Number:a.push(n.k0.pattern(/^\d+$/));break;case r.R.Range:a.push(n.k0.pattern(/^\d+\s*-\s*\d+$/))}return this.fb.group({ElementName:[t.ElementName,n.k0.required],Value:[t.Value,a]})}atLeastOneItemValidator(t){return o=>{const a=o.get(t);return a&&a.length>0?null:{required:!0}}}get evaluationItems(){return this.evaluationForm.get("evaluationData.EvaluationItems")}getElements(t){return this.evaluationItems.at(t).get("Elements")}addEvaluationItem(){const t=this.fb.group({ItemName:["",n.k0.required],type:[r.R.Number,n.k0.required],disabled:[!1],Elements:this.fb.array([],n.k0.required)},{validators:this.atLeastOneItemValidator("Elements")});this.evaluationItems.push(t)}addElementToItem(t,o){this.getElements(t).push(this.fb.group({ElementName:["",n.k0.required],Value:["",[n.k0.required,this.getValidator(o)]]}))}removeEvaluationItem(t){this.evaluationItems.removeAt(t)}removeElement(t,o){this.getElements(t).removeAt(o)}onSubmit(){if(this.evaluationForm.valid){this.id?this.addEmployeeEvaluationTypeFacade.UpdateEmployeeEvaluationType({...this.evaluationForm.value,id:this.id}):this.addEmployeeEvaluationTypeFacade.AddEmployeeEvaluationType(this.evaluationForm.value);const t=this.addEmployeeEvaluationTypeFacade.AddEmployeeEvaluation$.subscribe(o=>{1==o.type&&(this.router.navigate(["ShowEmployeeEvaluationType"]),t.unsubscribe())})}else console.log("Form is invalid")}getValidator(t){switch(t){case r.R.Number:return n.k0.pattern(/^\d+$/);case r.R.Range:return n.k0.pattern(/^\d+\s*-\s*\d+$/);default:return n.k0.required}}static#e=this.\u0275fac=function(o){return new(o||u)(e.rXU(n.ok),e.rXU(b),e.rXU(c.nX),e.rXU(c.Ix))};static#t=this.\u0275cmp=e.VBU({type:u,selectors:[["add-employee-evaluation-type"]],decls:24,vars:5,consts:[[1,"card"],[1,"card-body"],[1,"container","mt-4",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","name",1,"form-label"],["id","name","formControlName","name","type","text","placeholder","\u0623\u062f\u062e\u0644 \u0627\u0644\u0627\u0633\u0645",1,"form-control"],["class","text-danger mt-1",4,"ngIf"],[1,"d-flex","gap-2"],["id","isForCitizens","formControlName","isForCitizens","type","checkbox",1,"form-check-input"],["for","isForCitizens",1,"form-check-label"],["formGroupName","evaluationData",1,"mt-4"],["class","text-danger",4,"ngIf"],["formArrayName","EvaluationItems"],["class","card mb-3",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-primary","mt-3",3,"click"],["type","submit",1,"btn","btn-success","mt-4",3,"disabled"],[1,"text-danger","mt-1"],[4,"ngIf"],[1,"text-danger"],[1,"card","mb-3",3,"formGroupName"],[1,"card-title"],["for","itemName",1,"form-label"],["id","itemName","formControlName","ItemName","type","text","placeholder","\u0623\u062f\u062e\u0644 \u0627\u0633\u0645 \u0627\u0644\u0639\u0646\u0635\u0631",1,"form-control"],[1,"d-flex","gap-2","mb-3"],["formControlName","disabled","type","checkbox",1,"form-check-input",3,"id"],[1,"form-check-label",3,"for"],[1,"form-label",3,"for"],["formControlName","type",1,"form-select",3,"id"],[3,"value",4,"ngFor","ngForOf"],["formArrayName","Elements"],["class","border p-3 mb-3 rounded",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],["type","button",1,"btn","btn-danger","btn-sm","mt-3",3,"click"],[3,"value"],[1,"border","p-3","mb-3","rounded",3,"formGroupName"],["for","elementName",1,"form-label"],["id","elementName","formControlName","ElementName","type","text","placeholder","\u0623\u062f\u062e\u0644 \u0627\u0633\u0645 \u0627\u0644\u0639\u0646\u0635\u0631",1,"form-control"],["for","value",1,"form-label"],[3,"ngSwitch"],["id","value","formControlName","Value","type","number","class","form-control","placeholder","\u0623\u062f\u062e\u0644 \u0627\u0644\u0642\u064a\u0645\u0629",4,"ngSwitchCase"],["id","value","formControlName","Value","type","text","class","form-control","placeholder","\u0623\u062f\u062e\u0644 \u0627\u0644\u0646\u0635",4,"ngSwitchCase"],["id","value","formControlName","Value","type","text","class","form-control","placeholder","\u0645\u062b\u0627\u0644: 0 - 20",4,"ngSwitchCase"],["id","value","formControlName","Value","type","checkbox","class","form-check-input",4,"ngSwitchCase"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],["id","value","formControlName","Value","type","number","placeholder","\u0623\u062f\u062e\u0644 \u0627\u0644\u0642\u064a\u0645\u0629",1,"form-control"],["id","value","formControlName","Value","type","text","placeholder","\u0623\u062f\u062e\u0644 \u0627\u0644\u0646\u0635",1,"form-control"],["id","value","formControlName","Value","type","text","placeholder","\u0645\u062b\u0627\u0644: 0 - 20",1,"form-control"],["id","value","formControlName","Value","type","checkbox",1,"form-check-input"]],template:function(o,a){if(1&o&&(e.nrm(0,"app-loading")(1,"app-messages"),e.j41(2,"div",0)(3,"div",1)(4,"form",2),e.bIt("ngSubmit",function(){return a.onSubmit()}),e.j41(5,"div",3)(6,"label",4),e.EFF(7,"\u0627\u0644\u0627\u0633\u0645"),e.k0s(),e.nrm(8,"input",5),e.DNE(9,N,3,2,"div",6),e.k0s(),e.j41(10,"div",7),e.nrm(11,"input",8),e.j41(12,"label",9),e.EFF(13,"\u0644\u0644\u0645\u0648\u0627\u0637\u0646\u064a\u0646\u061f"),e.k0s()(),e.j41(14,"div",10)(15,"h3"),e.EFF(16,"\u0639\u0646\u0627\u0635\u0631 \u0627\u0644\u062a\u0642\u064a\u064a\u0645"),e.k0s(),e.DNE(17,G,3,0,"div",11),e.j41(18,"div",12),e.DNE(19,P,25,14,"div",13),e.j41(20,"button",14),e.bIt("click",function(){return a.addEvaluationItem()}),e.EFF(21,"\u0625\u0636\u0627\u0641\u0629 \u0639\u0646\u0635\u0631 \u062a\u0642\u064a\u064a\u0645"),e.k0s()()(),e.j41(22,"button",15),e.EFF(23,"\u0625\u0631\u0633\u0627\u0644"),e.k0s()()()()),2&o){let l;e.R7$(4),e.Y8G("formGroup",a.evaluationForm),e.R7$(5),e.Y8G("ngIf",(null==(l=a.evaluationForm.get("name"))?null:l.invalid)&&(null==(l=a.evaluationForm.get("name"))?null:l.touched)),e.R7$(8),e.Y8G("ngIf",a.evaluationItems.invalid&&a.evaluationItems.touched),e.R7$(2),e.Y8G("ngForOf",a.evaluationItems.controls),e.R7$(3),e.Y8G("disabled",a.evaluationForm.invalid)}},dependencies:[p.Sq,p.bT,p.ux,p.e1,n.qT,n.xH,n.y7,n.me,n.Q0,n.Zm,n.wz,n.BC,n.cb,n.j4,n.JD,n.$R,n.v8,k.q,j.y]})}return u})(),data:{breadcrumb:"\u0625\u0636\u0627\u0641\u0629 \u0625\u0639\u062a\u0645\u0627\u062f \u062c\u062f\u064a\u062f"}}];let L=(()=>{class u{static#e=this.\u0275fac=function(o){return new(o||u)};static#t=this.\u0275mod=e.$C({type:u});static#u=this.\u0275inj=e.G2t({imports:[c.iI.forChild(z),c.iI]})}return u})();var K=i(7591),q=i(9947);let H=(()=>{class u{static#e=this.\u0275fac=function(o){return new(o||u)};static#t=this.\u0275mod=e.$C({type:u});static#u=this.\u0275inj=e.G2t({providers:[f,b],imports:[p.MD,L,n.X1,K.G,q.i]})}return u})()},2802:(g,v,i)=>{i.d(v,{A:()=>c});const c={currentPage:0,items:[],pageSize:0,totalCount:0,totalPages:0}}}]);